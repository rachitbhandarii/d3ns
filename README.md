# D3NS | A Decentralised Domain Name System

## IDEA

The current root DNS is centrally owned by the ICANN, and thus comes under censorship, delayed and costly authorisations and is vulnerable to spoofing, single point failure, and DDoS attacks. A decentralised domain name system removes the hold of a single authority over the entire root DNS. We propose D3NS, which is a web3 motivated decentralised domain name system, where every DNS Server is a node in the blockchain network, where the records are stored on a blockchain and the communication occurs over the UDP channel just like the current DNS.

---

## DESIGN

We have a decentralised design for this application. One can spawn multiple instances of the D3NS Server, where each server is bound to some unique IP address and port, and adds other servers in the blockchain to its peer list.

The blockchain network is designed to support the PoA (Proof of Authority) consensus algorithm, which believes that each node inside the consortium is trusted and thus it is a private blockchain network.

Such a design helps achieve decentralisation without compromising on security. Usually the PoW and PoS consensus algorithms are used in a blockchain network but we chose PoA as it is quite fast as compared to PoW (Proof of Work) and PoS (Proof of Stake) as it doesn’t require multiple parties to participate at once. In PoA each party comes and adds a block to the blockchain from the mempool in a round-robin fashion.

The D3NS Client is also made to query a random peer inside the blockchain network instead of querying a single peer server, thus, not putting lots of load on a single instance, which is a benefit of the web3 applications.

The communication takes place over UDP as it is fast and already used in the traditional DNS Systems.

---

## IMPLEMENTATION

Our codebase comprises of 3 packages, namely →

1. **client** → comprises of the UDPClient class which is run at the client side.
2. **server** → comprises of the UDPServer class which is run at the server side. 
3. **core** → comprises of the core blockchain implementation as well as the json messaging protocol (POJO) and a DnsTransaction record which is used to store the domain names and their IPs inside the blockchain.

### Inspecting Each File

- **client/UDPClient** → It supports the client side CLI interface, where we need to pass the parameters of the type of operation to be performed [QUERY, ADD] (to query the server or add a record to the server respectively) and the domain name and IP address (only required for ADD functionality) as well as the peer list of the servers that are part of the blockchain network.
- **server/UDPServer** → It supports the server side CLI interface, where we need to pass the parameters: host, port and peers which mean the server address, the port server binds to and the peers with which the server connects inside the blockchain network. It handles multiple operations like [QUERY, ADD, TX_BROADCAST, BLOCK_BROADCAST, CHAIN_REQUEST, CHAIN_RESPONSE], where the first two are the client side operations. If a transaction to be handled by some other peer is send to the server then it makes use of TX_BROADCAST. After every block creation, the block is broadcasted to all the peers so that every peer is in sync. This is done using BLOCK_BROADCAST. At the start and updations, the server requests the chain from its peers who have a greater block height than the server itself. This is done using CHAIN_REQUEST and a CHAIN_RESPONSE is generated by the peer server confirming the chain transfer.
- **core/Block** → It is a unit of the Blockchain which comprises of a DnsTransaction, its index inside the blockchain, the time at which the block was generated, the id of the validator peer of this block, the previous block’s hash and the current block’s hash. It also provides a utility to compute the hash of the block.
- **core/Blockchain** → The blockchain stores the blocks inside an immutable array list of blocks, where each block’s hash is dependent on its content and the previous block’s hash, somewhat similar to checksum but for a chain of data. A dummy block also known as a genesis block is always generated at the start of the blockchain to avoid null values in the actual transactions. It helps produce blocks and resolve the IP address of a domain name as well.
- **core/DnsTransaction** → It is a record that is stored inside each block which compromises of the domain name and the IP address corresponding to it.
- **core/JsonMessage** → It is a POJO class which defines the keys of the JSON messaging protocol, i.e., type and payload, where the type refers to the type of operation in the form of a string to be performed and the payload consists of the flattened JSON data to be communicated.
- **core/Mempool** → Mempool is a queue which stores the unverified transactions temporarily till they are added to the blockchain by some server peer.
- **core/PeerManager** → The peer manager consists of a set of the addresses of each peer in the blockchain network and provides functionality to add and get peers and the sorted list of validators present in the network for PoA round robin implementation.

---

## SETUP & RUN

1. Clone the repository
    
    ```bash
    git clone https://github.com/rachitbhandarii/d3ns.git
    cd d3ns
    ```
    
2. Build the project using maven
    
    ```bash
    mvn clean package
    ```
    
3. Start the D3NS Server (you can run multiple instances)
    
    ```bash
    java -jar ./target/d3ns-beta-server.jar	--host <host_address> --port <port_number> --peers <peer1_address>:<peer1_port_number>,<peer2_address>:<peer2_port_number>...
    ```
    
4. Query or make modifications using the D3NS Client
    
    For adding a new record to the blockchain network
    
    ```bash
    java -jar ./target/d3ns-beta-client.jar	add --domain <domain_name> --ip <ip_address> --peers <peer1_address>:<peer1_port_number>,<peer2_address>:<peer2_port_number>...
    ```
    
    For querying the blockchain network
    
    ```bash
    java -jar ./target/d3ns-beta-client.jar	query --domain <domain_name> --peers <peer1_address>:<peer1_port_number>,<peer2_address>:<peer2_port_number>...
    ```
    
---
